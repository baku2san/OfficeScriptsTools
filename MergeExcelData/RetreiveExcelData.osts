{"version":"0.2.0","body":"function main(\n  workbook: ExcelScript.Workbook,\n): object {\n  let topLeftAddress: string = \"B6\";\n\n  let retreiveData: JSON;\n  try {\n    let targetSheet = workbook.getActiveWorksheet();\n    let usedRange = targetSheet.getUsedRange();\n    let lastCell = usedRange.getLastCell();\n    let addressWithSheet = lastCell.getAddressLocal();;\n    let regExp = new RegExp(\"!(?<columnName>[a-zA-Z]+)(?<rowValue>\\\\d+)\");\n    let match = addressWithSheet.match(regExp);\n    let lastColumnName = match.groups[\"columnName\"];            // ex.) 'H'\n    let lastRowValue = match.groups[\"rowValue\"];                // ex.) '17'\n    let lastCellName = lastColumnName + lastRowValue;           // ex.) 'H17'\n\n    regExp = new RegExp(\"(?<columnName>[a-zA-Z]+)(?<rowValue>\\\\d+)\")\n    match = topLeftAddress.match(regExp);\n    let firstColumn = match.groups[\"columnName\"];\n    let firstRow = match.groups[\"rowValue\"];\n    let dataBeginRow = + firstRow + 1\n\n    // get TableLikeData to 2 demension array \n    let headers = targetSheet.getRange(firstColumn + firstRow + \":\" + lastColumnName + firstRow).getValues()\n      .reduce((a, b) => { a.push(...b); return a }, [])\t\t// 二次元 to 一次元;\n    let dataRnageValues = targetSheet.getRange(firstColumn + dataBeginRow + \":\" + lastCellName).getValues();\n    retreiveData = <JSON><unknown>{\n      \"headers\": headers,\n      \"data\": dataRnageValues,\n    };\n    console.log(\"successfully retreived.\");\n  } catch (error) {\n    if (error instanceof Error) {\n      console.log(error.message)\n    } else if (typeof error === 'string') {\n      console.log(error)\n    } else {\n      console.log(\"something went wrong.\")\n    }\n  }\n\n  return retreiveData;\n}","description":"","parameterInfo":null,"apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}